# AI股票价值投资分析系统 - 需求文档

## 1. 系统概述

### 1.1 项目背景
原有的AI财报分析系统主要功能是下载和解析财务报告，现在需要将财报分析功能升级为价值投资分析功能，保留财报下载功能的同时，增加基于价值投资理念的股票分析功能。

### 1.2 系统目标
- 保留原有的财报下载功能
- 实现价值投资分析功能
- 提供直观的Web界面
- 支持实时股票数据分析
- 生成投资建议和评分

### 1.3 技术架构
- **后端**: Go + Gin框架
- **前端**: 原生HTML + CSS + JavaScript
- **图表库**: Chart.js
- **数据源**: 新浪财经API
- **部署**: 单一可执行文件，嵌入Web界面

## 2. 功能需求

### 2.1 财报下载功能（保留）

#### 2.1.1 功能描述
- 支持按公司名称下载财务报告
- 支持按年份筛选报告
- 支持季度报告和年度报告
- 提供下载历史记录

#### 2.1.2 接口设计
```
POST /api/download
请求参数：
{
    "company_name": "公司名称",
    "year": "年份（可选）"
}

响应格式：
{
    "message": "下载成功",
    "files": [
        {
            "title": "报告标题",
            "file_name": "文件名",
            "file_path": "文件路径"
        }
    ]
}
```

#### 2.1.3 数据存储
- 下载目录：`downloads/公司名/年份/`
- 文件格式：PDF
- 文件命名规则：`年份报告类型_公司名.pdf`

### 2.2 价值投资分析功能（新增）

#### 2.2.1 功能描述
- 支持股票名称或代码输入
- 获取股票基本信息
- 计算价值投资评分
- 生成投资建议
- 展示财务指标
- 提供图表可视化

#### 2.2.2 接口设计
```
POST /api/value-investment/analyze
请求参数：
{
    "stock_name": "股票名称或代码"
}

响应格式：
{
    "success": true,
    "data": {
        "code": "股票代码",
        "name": "股票名称",
        "price": 当前价格,
        "change": 涨跌额,
        "change_pct": 涨跌幅,
        "volume": 成交量,
        "amount": 成交额,
        "pe_ratio": 市盈率,
        "pb_ratio": 市净率,
        "roe": 净资产收益率,
        "debt_ratio": 资产负债率,
        "current_ratio": 流动比率,
        "gross_margin": 毛利率,
        "net_margin": 净利率,
        "revenue_growth": 营收增长率,
        "profit_growth": 利润增长率,
        "dividend_yield": 股息率,
        "eps": 每股收益,
        "bvps": 每股净资产,
        "value_score": 价值评分,
        "recommendation": 投资建议,
        "analysis_time": 分析时间
    }
}
```

#### 2.2.3 价值评分算法

##### 评分维度
1. **市盈率(P/E)评分**：15-25倍为最佳（20分）
2. **净资产收益率(ROE)评分**：15%以上为优秀（20分）
3. **资产负债率评分**：低于50%为健康（15分）
4. **流动比率评分**：大于1.5为健康（10分）
5. **营收增长率评分**：10%以上为优秀（10分）
6. **利润增长率评分**：15%以上为优秀（10分）
7. **股息率评分**：3%以上为优秀（5分）

##### 评分等级
- **80-100分**：强烈建议买入
- **60-79分**：建议买入
- **40-59分**：建议持有
- **20-39分**：建议观望
- **0-19分**：建议回避

#### 2.2.4 支持的股票
系统支持主要A股股票，包括：
- 银行股：招商银行、工商银行、建设银行、中国银行等
- 白酒股：贵州茅台等
- 保险股：中国平安等
- 其他蓝筹股：云南白药、万科A、中国宝安等

## 3. 界面需求

### 3.1 页面布局
- **顶部导航**：系统标题和描述
- **标签页导航**：财报下载、价值投资分析
- **内容区域**：根据选择的标签页显示相应内容

### 3.2 财报下载页面
- 公司名称输入框
- 年份输入框（可选）
- 下载按钮
- 下载结果展示
- 历史文件列表

### 3.3 价值投资分析页面
- 股票名称/代码输入框
- 分析按钮
- 基本信息展示（股票代码、名称、价格等）
- 价值评分展示（圆形评分图）
- 投资建议展示
- 财务指标网格（12项指标）
- 图表展示（雷达图、柱状图）

### 3.4 设计规范
- **响应式设计**：支持移动端和桌面端
- **色彩方案**：主色调为蓝紫色渐变
- **交互反馈**：按钮状态、加载状态、错误提示
- **数据可视化**：使用Chart.js绘制图表

## 4. 技术需求

### 4.1 后端技术栈
- **编程语言**: Go 1.19+
- **Web框架**: Gin
- **数据源**: 新浪财经API
- **文件存储**: 本地文件系统
- **嵌入技术**: Go embed

### 4.2 前端技术栈
- **HTML5**: 语义化标签
- **CSS3**: Flexbox、Grid布局
- **JavaScript**: ES6+、Fetch API
- **图表库**: Chart.js 4.x
- **样式框架**: 自定义CSS

### 4.3 性能要求
- 响应时间：API请求 < 3秒
- 并发支持：100+ 同时用户
- 内存使用： < 100MB
- 文件大小：单一可执行文件 < 50MB

### 4.4 安全要求
- 输入验证：防止SQL注入、XSS攻击
- 错误处理：友好的错误提示
- 数据保护：不存储用户敏感信息

## 5. 部署需求

### 5.1 系统要求
- **操作系统**: Linux/macOS/Windows
- **Go版本**: 1.19+
- **内存**: 最少512MB
- **存储**: 最少1GB
- **网络**: 需要访问外部API

### 5.2 部署方式
```bash
# 编译
go build main.go

# 运行
./main.go

# 或直接运行
go run main.go
```

### 5.3 访问方式
- **Web界面**: http://localhost:8082
- **API接口**: http://localhost:8082/api/*
- **文件下载**: http://localhost:8082/downloads/*

## 6. 数据流设计

### 6.1 财报下载流程
1. 用户输入公司名称和年份
2. 前端发送请求到 `/api/download`
3. 后端调用CNINFO API获取报告列表
4. 下载PDF文件到本地
5. 返回下载结果给前端
6. 前端显示下载成功和文件列表

### 6.2 价值投资分析流程
1. 用户输入股票名称或代码
2. 前端发送请求到 `/api/value-investment/analyze`
3. 后端将股票名称转换为代码
4. 调用新浪财经API获取基本信息
5. 计算财务指标（模拟数据）
6. 计算价值评分和投资建议
7. 返回分析结果给前端
8. 前端展示分析结果和图表

## 7. 测试需求

### 7.1 功能测试
- 财报下载功能测试
- 价值投资分析测试
- 不同股票代码测试
- 边界条件测试

### 7.2 性能测试
- 并发请求测试
- 大数据量测试
- 长时间运行测试

### 7.3 兼容性测试
- 浏览器兼容性测试
- 移动端适配测试
- 不同屏幕分辨率测试

## 8. 维护需求

### 8.1 日志记录
- API请求日志
- 错误日志
- 性能监控日志

### 8.2 监控告警
- API失败告警
- 服务不可用告警
- 性能异常告警

### 8.3 数据备份
- 下载文件备份
- 配置文件备份
- 日志文件备份

## 9. 扩展需求

### 9.1 功能扩展
- 更多股票支持
- 实时数据更新
- 历史数据分析
- 投资组合管理

### 9.2 技术扩展
- 数据库存储
- 用户认证
- 移动端APP
- API接口开放

### 9.3 业务扩展
- 付费功能
- 高级分析
- 个性化推荐
- 社区功能

## 10. 风险评估

### 10.1 技术风险
- 外部API不可用
- 数据格式变更
- 性能瓶颈
- 安全漏洞

### 10.2 业务风险
- 股票市场波动
- 监管政策变化
- 用户需求变化
- 竞争对手

### 10.3 风险应对
- API备用方案
- 数据缓存机制
- 性能优化方案
- 安全加固措施

---

## 版本历史

- **v1.0**: 原始财报下载系统
- **v2.0**: 新增价值投资分析功能
- **v2.1**: 优化界面和用户体验
- **v2.2**: 增加更多股票支持

## 联系方式

如有问题或建议，请联系开发团队。