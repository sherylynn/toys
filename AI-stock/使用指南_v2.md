# 🎯 AI股票价值投资分析系统 v2.0 - 使用指南

## 🌟 系统简介

AI股票价值投资分析系统 v2.0 是一个集成了财报下载、价值投资分析和持仓管理功能的智能投资助手。系统采用Go语言开发，使用SQLite数据库管理持仓数据，提供完整的Web界面。

## 🚀 快速开始

### 1. 启动系统
```bash
# 编译并运行
go build -o ai-stock main.go
./ai-stock

# 或后台运行
nohup ./ai-stock > server.log 2>&1 &
```

### 2. 访问系统
打开浏览器访问：**http://localhost:8084**

## 🎯 主要功能

### 💰 财报下载功能
- **功能描述**：下载上市公司财务报告
- **支持范围**：A股主要上市公司
- **报告类型**：年度报告、半年度报告、季度报告
- **存储位置**：`downloads/公司名/年份/`

### 📊 价值投资分析功能
- **智能评分**：基于7个维度的0-100分评分系统
- **实时数据**：获取股票价格和财务指标
- **图表展示**：雷达图和柱状图可视化
- **投资建议**：根据评分给出投资建议

### 🗂️ 持仓管理功能（新增）
- **持仓记录**：记录股票代码、名称、数量、买入价格等
- **实时盈亏**：自动获取最新价格，计算盈亏金额和收益率
- **数据持久化**：使用SQLite数据库存储持仓数据
- **统计汇总**：显示总成本、当前市值、总盈亏等统计信息

## 🎨 界面展示

### 主界面
- **顶部导航**：系统标题和描述
- **标签页切换**：财报下载、价值投资分析、持仓管理
- **响应式设计**：支持移动端和桌面端

### 持仓管理页面
```
┌─────────────────────────────────────┐
│ 持仓管理                            │
│                                     │
│ [添加持仓] [更新价格] [刷新]         │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 股票代码 │股票名称 │数量 │买入价 │ │
│ ├─────────────────────────────────┤ │
│ │ 000538  │云南白药 │100  │55.50  │ │
│ │ 600036  │招商银行 │200  │35.80  │ │
│ └─────────────────────────────────┘ │
│                                     │
│ 持仓统计:                           │
│ 持仓数量: 2                         │
│ 总成本: ¥12,710.00                  │
│ 当前市值: ¥14,410.00                 │
│ 总盈亏: +¥1,700.00 (+13.38%)        │
└─────────────────────────────────────┘
```

## 🗄️ 数据库结构

### 持仓表 (positions)
```sql
CREATE TABLE positions (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    stock_code TEXT NOT NULL,
    stock_name TEXT NOT NULL,
    shares INTEGER NOT NULL,
    buy_price REAL NOT NULL,
    notes TEXT,
    buy_date TEXT NOT NULL,
    created_at TEXT NOT NULL,
    updated_at TEXT NOT NULL
);
```

## 📈 价值评分系统

### 评分维度
1. **市盈率(P/E)**：15-25倍为最佳 (20分)
2. **净资产收益率(ROE)**：15%以上为优秀 (20分)
3. **资产负债率**：低于50%为健康 (15分)
4. **流动比率**：大于1.5为健康 (10分)
5. **营收增长率**：10%以上为优秀 (10分)
6. **利润增长率**：15%以上为优秀 (10分)
7. **股息率**：3%以上为优秀 (5分)

### 评分等级
- **🟢 80-100分**：强烈建议买入
- **🔵 60-79分**：建议买入
- **🟡 40-59分**：建议持有
- **🟠 20-39分**：建议观望
- **🔴 0-19分**：建议回避

## 🎯 使用示例

### 1. 添加持仓
1. 点击"持仓管理"标签页
2. 点击"添加持仓"按钮
3. 填写股票代码、名称、数量、买入价格
4. 点击"确定"完成添加

### 2. 查看持仓盈亏
1. 在持仓管理页面查看所有持仓
2. 系统自动显示当前价格和盈亏情况
3. 查看底部的持仓统计信息

### 3. 更新持仓价格
1. 点击"更新价格"按钮
2. 系统自动获取所有持仓的最新价格
3. 重新计算盈亏金额和收益率

### 4. 价值投资分析
1. 点击"价值投资分析"标签页
2. 输入股票名称（如：云南白药）或代码（如：000538）
3. 点击"分析"按钮
4. 查看分析结果，包括：
   - 基本信息（价格、涨跌幅等）
   - 价值评分和投资建议
   - 12项财务指标详情
   - 雷达图和柱状图

### 5. 财报下载
1. 点击"财报下载"标签页
2. 输入公司名称（如：云南白药）
3. 可选择年份（可选）
4. 点击"下载财报"按钮
5. 查看下载结果和文件列表

## 🔧 技术特性

### 后端技术
- **语言**：Go 1.21+
- **框架**：Gin
- **数据库**：SQLite3
- **API**：RESTful API
- **数据源**：新浪财经API
- **部署**：单一可执行文件

### 前端技术
- **HTML5**：语义化标签
- **CSS3**：Flexbox、Grid布局
- **JavaScript**：ES6+、Fetch API
- **图表**：Chart.js

### 系统特性
- **响应式设计**：支持各种设备
- **实时数据**：获取最新股票信息
- **智能分析**：基于价值投资理念
- **数据持久化**：SQLite数据库存储
- **可视化**：直观的图表展示
- **高性能**：Go语言并发优势

## 🛠️ API接口

### 持仓管理API
```bash
# 获取持仓列表
GET /api/positions

# 添加持仓
POST /api/positions
Content-Type: application/json
{
    "stock_code": "000538",
    "stock_name": "云南白药",
    "shares": 100,
    "buy_price": 55.50,
    "notes": "测试持仓"
}

# 更新持仓
PUT /api/positions/:id
Content-Type: application/json
{
    "shares": 200,
    "buy_price": 54.00,
    "notes": "更新备注"
}

# 删除持仓
DELETE /api/positions/:id

# 更新持仓价格
POST /api/positions/update-prices
```

### 价值投资分析API
```bash
POST /api/value-investment/analyze
Content-Type: application/json

{
    "stock_name": "云南白药"
}
```

### 财报下载API
```bash
POST /api/download
Content-Type: application/json

{
    "company_name": "云南白药",
    "year": "2024"
}
```

## 🎨 界面特色

### 视觉设计
- **主色调**：蓝紫色渐变 (#667eea → #764ba2)
- **评分色彩**：
  - 优秀：绿色 (#4CAF50)
  - 良好：蓝色 (#2196F3)
  - 一般：橙色 (#FF9800)
  - 较差：红色 (#f44336)

### 交互体验
- **实时反馈**：按钮状态、加载动画
- **错误处理**：友好的错误提示
- **数据展示**：清晰的表格和图表
- **响应式**：适配各种屏幕尺寸

## 📊 支持的股票

### 银行股
- 招商银行(600036)、工商银行(601398)、建设银行(601939)
- 中国银行(601988)、农业银行(601288)、交通银行(601328)

### 保险股
- 中国平安(601318)、中国人寿(601628)、中国太保(601601)

### 白酒股
- 贵州茅台(600519)、五粮液(000858)、洋河股份(002304)

### 其他蓝筹股
- 云南白药(000538)、万科A(000002)、中国宝安(000009)
- 格力电器(000651)、美的集团(000333)、海康威视(002415)

## 🔍 故障排除

### 常见问题
1. **端口占用**：系统默认使用8084端口，可在main.go中修改
2. **API无响应**：检查网络连接和API状态
3. **图表不显示**：确保能访问Chart.js CDN
4. **下载失败**：检查公司名称是否正确
5. **数据库错误**：检查positions.db文件权限

### 日志查看
```bash
# 查看服务器日志
tail -f server.log

# 查看进程状态
ps aux | grep "ai-stock"
```

### 数据库管理
```bash
# 查看数据库内容
sqlite3 positions.db ".tables"
sqlite3 positions.db "SELECT * FROM positions;"

# 备份数据库
cp positions.db positions_backup.db
```

## 🎉 更新日志

### v2.0 (当前版本)
- ✅ 新增持仓管理功能
- ✅ 集成SQLite数据库
- ✅ 修复中文显示乱码问题
- ✅ 添加实时盈亏计算
- ✅ 完善API接口
- ✅ 优化用户界面

### v1.0
- ✅ 基础财报下载功能
- ✅ 价值投资分析功能
- ✅ Web界面实现

## 📞 技术支持

- **访问地址**：http://localhost:8084
- **API文档**：内置RESTful API
- **日志系统**：完整的错误处理和日志记录
- **数据库**：SQLite自动创建和管理

---

**🌐 系统特色**：单一可执行文件，无需额外依赖，开箱即用！  
**🔄 数据更新**：实时获取股票价格，自动计算盈亏  
**📈 投资辅助**：基于价值投资理念，提供专业的投资分析